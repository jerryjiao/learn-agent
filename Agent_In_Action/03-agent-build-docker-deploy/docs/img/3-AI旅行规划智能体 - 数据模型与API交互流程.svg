<svg viewBox="0 0 1400 1100" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: 'SimSun', serif; font-size: 26px; font-weight: bold; fill: #1a1a1a; }
      .subtitle { font-family: 'SimSun', serif; font-size: 14px; fill: #333; }
      .label-cn { font-family: 'SimSun', serif; font-size: 12px; fill: #2c3e50; }
      .label-en { font-family: 'Times New Roman', serif; font-size: 10px; fill: #555; font-style: italic; }
      .formula { font-family: 'Times New Roman', serif; font-size: 11px; fill: #c0392b; font-style: italic; }
      .entity-box { fill: #fff; stroke: #34495e; stroke-width: 2; }
      .api-box { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .storage-box { fill: #f39c12; stroke: #d68910; stroke-width: 2; }
      .process-box { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .arrow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .arrow-data { stroke: #e74c3c; stroke-width: 2; fill: none; marker-end: url(#arrowhead-red); }
      .code-bg { fill: #f8f9fa; stroke: #dee2e6; stroke-width: 1; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#34495e" />
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#e74c3c" />
    </marker>
    <filter id="shadow">
      <feDropShadow dx="1.5" dy="1.5" stdDeviation="1.5" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="700" y="35" text-anchor="middle" class="title">æ•°æ®æ¨¡å‹ä¸APIäº¤äº’æµç¨‹</text>
  <text x="700" y="57" text-anchor="middle" class="subtitle">Data Models and API Interaction Flow</text>

  <!-- Data Entities Section -->
  <rect x="30" y="80" width="650" height="450" class="code-bg" rx="8" filter="url(#shadow)"/>
  <text x="50" y="105" class="label-cn" font-weight="bold" font-size="15">æ ¸å¿ƒæ•°æ®å®ä½“ (Core Data Entities)</text>

  <!-- TravelRequest Entity -->
  <rect x="50" y="120" width="290" height="190" class="entity-box" rx="6" filter="url(#shadow)"/>
  <text x="195" y="140" text-anchor="middle" class="label-cn" font-weight="bold">TravelRequest</text>
  <text x="195" y="156" text-anchor="middle" class="label-en">User Input Model</text>
  <line x1="60" y1="165" x2="330" y2="165" stroke="#dee2e6" stroke-width="1"/>
  <text x="70" y="182" class="label-cn" font-size="11">â€¢ destination: str</text>
  <text x="70" y="197" class="label-cn" font-size="11">â€¢ start_date: date</text>
  <text x="70" y="212" class="label-cn" font-size="11">â€¢ end_date: date</text>
  <text x="70" y="227" class="label-cn" font-size="11">â€¢ budget: float</text>
  <text x="70" y="242" class="label-cn" font-size="11">â€¢ group_size: int</text>
  <text x="70" y="257" class="label-cn" font-size="11">â€¢ interests: List[str]</text>
  <text x="70" y="272" class="label-cn" font-size="11">â€¢ accommodation_pref: str</text>
  <text x="70" y="290" class="formula" font-size="10">Validation: budget > 0 âˆ§ dates valid</text>

  <!-- DayPlan Entity -->
  <rect x="370" y="120" width="290" height="190" class="entity-box" rx="6" filter="url(#shadow)"/>
  <text x="515" y="140" text-anchor="middle" class="label-cn" font-weight="bold">DayPlan</text>
  <text x="515" y="156" text-anchor="middle" class="label-en">Daily Itinerary Model</text>
  <line x1="380" y1="165" x2="650" y2="165" stroke="#dee2e6" stroke-width="1"/>
  <text x="390" y="182" class="label-cn" font-size="11">â€¢ day: int</text>
  <text x="390" y="197" class="label-cn" font-size="11">â€¢ date: str</text>
  <text x="390" y="212" class="label-cn" font-size="11">â€¢ weather: Weather</text>
  <text x="390" y="227" class="label-cn" font-size="11">â€¢ attractions: List[Attraction]</text>
  <text x="390" y="242" class="label-cn" font-size="11">â€¢ restaurants: List[Attraction]</text>
  <text x="390" y="257" class="label-cn" font-size="11">â€¢ transportation: List[Transport]</text>
  <text x="390" y="272" class="label-cn" font-size="11">â€¢ daily_cost: float</text>
  <text x="390" y="290" class="formula" font-size="10">Cost_day = Î£(activities + meals + transport)</text>

  <!-- TripSummary Entity -->
  <rect x="50" y="325" width="290" height="190" class="entity-box" rx="6" filter="url(#shadow)"/>
  <text x="195" y="345" text-anchor="middle" class="label-cn" font-weight="bold">TripSummary</text>
  <text x="195" y="361" text-anchor="middle" class="label-en">Complete Trip Output</text>
  <line x1="60" y1="370" x2="330" y2="370" stroke="#dee2e6" stroke-width="1"/>
  <text x="70" y="387" class="label-cn" font-size="11">â€¢ destination: str</text>
  <text x="70" y="402" class="label-cn" font-size="11">â€¢ total_days: int</text>
  <text x="70" y="417" class="label-cn" font-size="11">â€¢ itinerary: List[DayPlan]</text>
  <text x="70" y="432" class="label-cn" font-size="11">â€¢ hotels: List[Hotel]</text>
  <text x="70" y="447" class="label-cn" font-size="11">â€¢ total_cost: float</text>
  <text x="70" y="462" class="label-cn" font-size="11">â€¢ travel_tips: List[str]</text>
  <text x="70" y="477" class="label-cn" font-size="11">â€¢ weather_summary: Dict</text>
  <text x="70" y="495" class="formula" font-size="10">Total_Cost = Î£(day_costs) + hotel_costs</text>

  <!-- PlanningTaskStatus Entity -->
  <rect x="370" y="325" width="290" height="190" class="entity-box" rx="6" filter="url(#shadow)"/>
  <text x="515" y="345" text-anchor="middle" class="label-cn" font-weight="bold">PlanningTaskStatus</text>
  <text x="515" y="361" text-anchor="middle" class="label-en">Task State Management</text>
  <line x1="380" y1="370" x2="650" y2="370" stroke="#dee2e6" stroke-width="1"/>
  <text x="390" y="387" class="label-cn" font-size="11">â€¢ task_id: UUID</text>
  <text x="390" y="402" class="label-cn" font-size="11">â€¢ status: TaskStatus</text>
  <text x="390" y="417" class="label-cn" font-size="11">â€¢ request: TravelRequest</text>
  <text x="390" y="432" class="label-cn" font-size="11">â€¢ result: TripSummary | None</text>
  <text x="390" y="447" class="label-cn" font-size="11">â€¢ progress: int (0-100)</text>
  <text x="390" y="462" class="label-cn" font-size="11">â€¢ created_at: datetime</text>
  <text x="390" y="477" class="label-cn" font-size="11">â€¢ completed_at: datetime | None</text>
  <text x="390" y="495" class="formula" font-size="10">Status âˆˆ {started, processing, completed, failed}</text>

  <!-- API Flow Section -->
  <rect x="710" y="80" width="660" height="450" class="code-bg" rx="8" filter="url(#shadow)"/>
  <text x="730" y="105" class="label-cn" font-weight="bold" font-size="15">APIäº¤äº’æµç¨‹ (API Interaction Flow)</text>

  <!-- Frontend -->
  <rect x="730" y="130" width="160" height="70" class="api-box" rx="6" filter="url(#shadow)"/>
  <text x="810" y="155" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">Streamlitå‰ç«¯</text>
  <text x="810" y="172" text-anchor="middle" class="label-en" fill="white" font-size="9">Frontend UI</text>
  <text x="810" y="188" text-anchor="middle" class="label-cn" fill="white" font-size="10">:8501</text>

  <!-- POST /plan -->
  <rect x="950" y="130" width="180" height="70" class="process-box" rx="6" filter="url(#shadow)"/>
  <text x="1040" y="152" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">POST /plan</text>
  <text x="1040" y="169" text-anchor="middle" class="label-en" fill="white" font-size="9">Create Planning Task</text>
  <text x="1040" y="186" text-anchor="middle" class="label-cn" fill="white" font-size="9">è¿”å›: task_id</text>

  <!-- Backend Service -->
  <rect x="1170" y="130" width="180" height="70" class="api-box" rx="6" filter="url(#shadow)"/>
  <text x="1260" y="155" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">FastAPIåç«¯</text>
  <text x="1260" y="172" text-anchor="middle" class="label-en" fill="white" font-size="9">Backend Service</text>
  <text x="1260" y="188" text-anchor="middle" class="label-cn" fill="white" font-size="10">:8080</text>

  <!-- Polling Status -->
  <rect x="730" y="240" width="160" height="70" class="process-box" rx="6" filter="url(#shadow)"/>
  <text x="810" y="262" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">çŠ¶æ€è½®è¯¢</text>
  <text x="810" y="279" text-anchor="middle" class="label-en" fill="white" font-size="9">Poll Status</text>
  <text x="810" y="296" text-anchor="middle" class="label-cn" fill="white" font-size="9">æ¯2ç§’æŸ¥è¯¢ä¸€æ¬¡</text>

  <!-- GET /status/{task_id} -->
  <rect x="950" y="240" width="180" height="70" class="process-box" rx="6" filter="url(#shadow)"/>
  <text x="1040" y="262" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">GET /status/:id</text>
  <text x="1040" y="279" text-anchor="middle" class="label-en" fill="white" font-size="9">Query Task Status</text>
  <text x="1040" y="296" text-anchor="middle" class="label-cn" fill="white" font-size="9">è¿”å›: è¿›åº¦+ç»“æœ</text>

  <!-- Agent Processing -->
  <rect x="1170" y="240" width="180" height="70" class="storage-box" rx="6" filter="url(#shadow)"/>
  <text x="1260" y="262" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">æ™ºèƒ½ä½“å¤„ç†</text>
  <text x="1260" y="279" text-anchor="middle" class="label-en" fill="white" font-size="9">Agent Processing</text>
  <text x="1260" y="296" text-anchor="middle" class="label-cn" fill="white" font-size="9">å¼‚æ­¥æ‰§è¡Œ</text>

  <!-- Download Result -->
  <rect x="730" y="350" width="160" height="70" class="process-box" rx="6" filter="url(#shadow)"/>
  <text x="810" y="372" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">ä¸‹è½½æŠ¥å‘Š</text>
  <text x="810" y="389" text-anchor="middle" class="label-en" fill="white" font-size="9">Download Report</text>
  <text x="810" y="406" text-anchor="middle" class="label-cn" fill="white" font-size="9">JSONæ–‡ä»¶</text>

  <!-- GET /download/{task_id} -->
  <rect x="950" y="350" width="180" height="70" class="process-box" rx="6" filter="url(#shadow)"/>
  <text x="1040" y="372" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">GET /download/:id</text>
  <text x="1040" y="389" text-anchor="middle" class="label-en" fill="white" font-size="9">Download Endpoint</text>
  <text x="1040" y="406" text-anchor="middle" class="label-cn" fill="white" font-size="9">FileResponse</text>

  <!-- Storage -->
  <rect x="1170" y="350" width="180" height="70" class="storage-box" rx="6" filter="url(#shadow)"/>
  <text x="1260" y="372" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">ç»“æœå­˜å‚¨</text>
  <text x="1260" y="389" text-anchor="middle" class="label-en" fill="white" font-size="9">Result Storage</text>
  <text x="1260" y="406" text-anchor="middle" class="label-cn" fill="white" font-size="9">results/*.json</text>

  <!-- Health Check -->
  <rect x="730" y="450" width="300" height="60" class="api-box" rx="6" filter="url(#shadow)"/>
  <text x="880" y="472" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">GET /health</text>
  <text x="880" y="489" text-anchor="middle" class="label-en" fill="white" font-size="9">System Health Check</text>
  <text x="880" y="503" text-anchor="middle" class="label-cn" fill="white" font-size="9">æ£€æŸ¥é…ç½®ä¸ç³»ç»ŸçŠ¶æ€</text>

  <!-- API Docs -->
  <rect x="1070" y="450" width="280" height="60" class="process-box" rx="6" filter="url(#shadow)"/>
  <text x="1210" y="472" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">GET /docs</text>
  <text x="1210" y="489" text-anchor="middle" class="label-en" fill="white" font-size="9">Interactive API Documentation</text>
  <text x="1210" y="503" text-anchor="middle" class="label-cn" fill="white" font-size="9">Swagger UI äº¤äº’å¼æ–‡æ¡£</text>

  <!-- Arrows for API flow -->
  <path d="M 890 165 L 950 165" class="arrow"/>
  <path d="M 1130 165 L 1170 165" class="arrow"/>
  <path d="M 810 200 L 810 240" class="arrow-data"/>
  <path d="M 890 275 L 950 275" class="arrow"/>
  <path d="M 1130 275 L 1170 275" class="arrow"/>
  <path d="M 810 310 L 810 350" class="arrow-data"/>
  <path d="M 890 385 L 950 385" class="arrow"/>
  <path d="M 1130 385 L 1170 385" class="arrow"/>

  <!-- Data Persistence Section -->
  <rect x="30" y="560" width="650" height="250" class="code-bg" rx="8" filter="url(#shadow)"/>
  <text x="50" y="585" class="label-cn" font-weight="bold" font-size="15">æ•°æ®æŒä¹…åŒ–ç­–ç•¥ (Data Persistence)</text>

  <!-- In-Memory State -->
  <rect x="50" y="605" width="280" height="110" class="storage-box" rx="6" filter="url(#shadow)"/>
  <text x="190" y="625" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">å†…å­˜çŠ¶æ€</text>
  <text x="190" y="641" text-anchor="middle" class="label-en" fill="white" font-size="9">In-Memory State</text>
  <line x1="60" y1="650" x2="320" y2="650" stroke="white" stroke-width="1"/>
  <text x="70" y="667" class="label-cn" fill="white" font-size="10">planning_tasks: Dict[UUID, Task]</text>
  <text x="70" y="685" class="label-cn" fill="white" font-size="10">è¿è¡Œæ—¶å¿«é€Ÿè®¿é—®</text>
  <text x="70" y="703" class="formula" fill="white" font-size="10">Access Time: O(1)</text>

  <!-- File Storage -->
  <rect x="370" y="605" width="280" height="110" class="storage-box" rx="6" filter="url(#shadow)"/>
  <text x="510" y="625" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">æ–‡ä»¶å­˜å‚¨</text>
  <text x="510" y="641" text-anchor="middle" class="label-en" fill="white" font-size="9">File Storage</text>
  <line x1="380" y1="650" x2="640" y2="650" stroke="white" stroke-width="1"/>
  <text x="390" y="667" class="label-cn" fill="white" font-size="10">tasks_state.json (çŠ¶æ€å¿«ç…§)</text>
  <text x="390" y="685" class="label-cn" fill="white" font-size="10">results/*.json (è§„åˆ’ç»“æœ)</text>
  <text x="390" y="703" class="formula" fill="white" font-size="10">Retention: 30 days (configurable)</text>

  <!-- Future: Database -->
  <rect x="50" y="730" width="600" height="70" fill="#d5f4e6" stroke="#27ae60" stroke-width="2" stroke-dasharray="5,3" rx="6" filter="url(#shadow)"/>
  <text x="350" y="752" text-anchor="middle" class="label-cn" font-weight="bold">ğŸ”® æœªæ¥æ‰©å±•: æ•°æ®åº“æŒä¹…åŒ–</text>
  <text x="350" y="769" text-anchor="middle" class="label-en" font-size="9">Future Enhancement: Database Persistence</text>
  <text x="70" y="788" class="label-cn" font-size="10">â€¢ PostgreSQL / MySQL: ç»“æ„åŒ–å­˜å‚¨ä»»åŠ¡ä¸ç»“æœ</text>
  <text x="430" y="788" class="label-cn" font-size="10">â€¢ Redis: åˆ†å¸ƒå¼çŠ¶æ€å…±äº«</text>

  <!-- External Services Section -->
  <rect x="710" y="560" width="660" height="250" class="code-bg" rx="8" filter="url(#shadow)"/>
  <text x="730" y="585" class="label-cn" font-weight="bold" font-size="15">å¤–éƒ¨æœåŠ¡é›†æˆ (External Services Integration)</text>

  <!-- DuckDuckGo -->
  <rect x="730" y="605" width="190" height="95" fill="#a29bfe" stroke="#341f97" stroke-width="2" rx="6" filter="url(#shadow)"/>
  <text x="825" y="627" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">DuckDuckGo</text>
  <text x="825" y="643" text-anchor="middle" class="label-en" fill="white" font-size="9">Web Search Engine</text>
  <text x="745" y="663" class="label-cn" fill="white" font-size="10">â€¢ æ— éœ€APIå¯†é’¥</text>
  <text x="745" y="678" class="label-cn" fill="white" font-size="10">â€¢ å®æ—¶ä¿¡æ¯æ£€ç´¢</text>
  <text x="745" y="693" class="formula" fill="white" font-size="9">Rate: Unlimited (throttled)</text>

  <!-- MCP Weather Server -->
  <rect x="950" y="605" width="190" height="95" fill="#00b894" stroke="#00a383" stroke-width="2" rx="6" filter="url(#shadow)"/>
  <text x="1045" y="627" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">MCPå¤©æ°”æœåŠ¡å™¨</text>
  <text x="1045" y="643" text-anchor="middle" class="label-en" fill="white" font-size="9">MCP Weather Server</text>
  <text x="965" y="663" class="label-cn" fill="white" font-size="10">â€¢ QWeather APIé›†æˆ</text>
  <text x="965" y="678" class="label-cn" fill="white" font-size="10">â€¢ ç»“æ„åŒ–å¤©æ°”æ•°æ®</text>
  <text x="965" y="693" class="formula" fill="white" font-size="9">API Key: QWEATHER_API_KEY</text>

  <!-- OpenAI API -->
  <rect x="1170" y="605" width="180" height="95" fill="#e17055" stroke="#d63031" stroke-width="2" rx="6" filter="url(#shadow)"/>
  <text x="1260" y="627" text-anchor="middle" class="label-cn" fill="white" font-weight="bold">OpenAI API</text>
  <text x="1260" y="643" text-anchor="middle" class="label-en" fill="white" font-size="9">LLM Service</text>
  <text x="1180" y="663" class="label-cn" fill="white" font-size="10">â€¢ claude-sonnet-4</text>
  <text x="1180" y="678" class="label-cn" fill="white" font-size="10">â€¢ æ™ºèƒ½ä½“æ¨ç†</text>
  <text x="1180" y="693" class="formula" fill="white" font-size="9">Required: OPENAI_API_KEY</text>

  <!-- Error Handling -->
  <rect x="730" y="720" width="620" height="80" fill="#fdcb6e" stroke="#f39c12" stroke-width="2" rx="6" filter="url(#shadow)"/>
  <text x="1040" y="742" text-anchor="middle" class="label-cn" font-weight="bold">âš ï¸ å®¹é”™æœºåˆ¶ (Error Handling)</text>
  <text x="745" y="762" class="label-cn" font-size="10">â€¢ APIå¤±è´¥é‡è¯•: exponential backoff (2^n Ã— base_delay)</text>
  <text x="745" y="778" class="label-cn" font-size="10">â€¢ è¶…æ—¶é™çº§: SimpleTravelAgent å¿«é€Ÿæ–¹æ¡ˆ (timeout > 300s)</text>
  <text x="745" y="794" class="label-cn" font-size="10">â€¢ Mockæ•°æ®å›é€€: ç¡®ä¿99%å¯ç”¨æ€§ (Availability = 1 - Î£(failure_rate_i))</text>

  <!-- Request/Response Flow -->
  <rect x="30" y="840" width="1340" height="240" class="code-bg" rx="8" filter="url(#shadow)"/>
  <text x="700" y="865" text-anchor="middle" class="label-cn" font-weight="bold" font-size="15">å®Œæ•´è¯·æ±‚å“åº”æµç¨‹ (End-to-End Request Flow)</text>

  <!-- Step 1 -->
  <rect x="50" y="885" width="150" height="80" fill="#74b9ff" stroke="#0984e3" stroke-width="2" rx="6"/>
  <text x="125" y="905" text-anchor="middle" class="label-cn" font-weight="bold" font-size="11">â‘  ç”¨æˆ·æäº¤</text>
  <text x="125" y="920" text-anchor="middle" class="label-en" font-size="9">User Submit</text>
  <text x="60" y="938" class="label-cn" font-size="9">å¡«å†™è¡¨å•</text>
  <text x="60" y="952" class="label-cn" font-size="9">TravelRequest</text>

  <!-- Step 2 -->
  <rect x="230" y="885" width="150" height="80" fill="#a29bfe" stroke="#6c5ce7" stroke-width="2" rx="6"/>
  <text x="305" y="905" text-anchor="middle" class="label-cn" font-weight="bold" font-size="11">â‘¡ APIæ¥æ”¶</text>
  <text x="305" y="920" text-anchor="middle" class="label-en" font-size="9">API Receive</text>
  <text x="240" y="938" class="label-cn" font-size="9">æ ¡éªŒæ•°æ®</text>
  <text x="240" y="952" class="label-cn" font-size="9">ç”Ÿæˆtask_id</text>

  <!-- Step 3 -->
  <rect x="410" y="885" width="150" height="80" fill="#fd79a8" stroke="#e84393" stroke-width="2" rx="6"/>
  <text x="485" y="905" text-anchor="middle" class="label-cn" font-weight="bold" font-size="11">â‘¢ å¼‚æ­¥å¤„ç†</text>
  <text x="485" y="920" text-anchor="middle" class="label-en" font-size="9">Async Process</text>
  <text x="420" y="938" class="label-cn" font-size="9">LangGraph</text>
  <text x="420" y="952" class="label-cn" font-size="9">å¤šæ™ºèƒ½ä½“åä½œ</text>

  <!-- Step 4 -->
  <rect x="590" y="885" width="150" height="80" fill="#ffeaa7" stroke="#fdcb6e" stroke-width="2" rx="6"/>
  <text x="665" y="905" text-anchor="middle" class="label-cn" font-weight="bold" font-size="11">â‘£ å·¥å…·è°ƒç”¨</text>
  <text x="665" y="920" text-anchor="middle" class="label-en" font-size="9">Tool Calls</text>
  <text x="600" y="938" class="label-cn" font-size="9">æœç´¢/å¤©æ°”</text>
  <text x="600" y="952" class="label-cn" font-size="9">å¤–éƒ¨API</text>

  <!-- Step 5 -->
  <rect x="770" y="885" width="150" height="80" fill="#55efc4" stroke="#00b894" stroke-width="2" rx="6"/>
  <text x="845" y="905" text-anchor="middle" class="label-cn" font-weight="bold" font-size="11">â‘¤ ç»“æœç”Ÿæˆ</text>
  <text x="845" y="920" text-anchor="middle" class="label-en" font-size="9">Generate Result</text>
  <text x="780" y="938" class="label-cn" font-size="9">TripSummary</text>
  <text x="780" y="952" class="label-cn" font-size="9">ä¿å­˜JSON</text>

  <!-- Step 6 -->
  <rect x="950" y="885" width="150" height="80" fill="#a29bfe" stroke="#6c5ce7" stroke-width="2" rx="6"/>
  <text x="1025" y="905" text-anchor="middle" class="label-cn" font-weight="bold" font-size="11">â‘¥ çŠ¶æ€æ›´æ–°</text>
  <text x="1025" y="920" text-anchor="middle" class="label-en" font-size="9">Update Status</text>
  <text x="960" y="938" class="label-cn" font-size="9">completed</text>
  <text x="960" y="952" class="label-cn" font-size="9">progress=100</text>

  <!-- Step 7 -->
  <rect x="1130" y="885" width="150" height="80" fill="#74b9ff" stroke="#0984e3" stroke-width="2" rx="6"/>
  <text x="1205" y="905" text-anchor="middle" class="label-cn" font-weight="bold" font-size="11">â‘¦ ç”¨æˆ·è·å–</text>
  <text x="1205" y="920" text-anchor="middle" class="label-en" font-size="9">User Retrieve</text>
  <text x="1140" y="938" class="label-cn" font-size="9">è½®è¯¢/ä¸‹è½½</text>
  <text x="1140" y="952" class="label-cn" font-size="9">æŸ¥çœ‹ç»“æœ</text>

  <!-- Flow arrows -->
  <path d="M 200 925 L 230 925" class="arrow"/>
  <path d="M 380 925 L 410 925" class="arrow"/>
  <path d="M 560 925 L 590 925" class="arrow"/>
  <path d="M 740 925 L 770 925" class="arrow"/>
  <path d="M 920 925 L 950 925" class="arrow"/>
  <path d="M 1100 925 L 1130 925" class="arrow"/>

  <!-- Time estimation -->
  <text x="700" y="995" text-anchor="middle" class="formula" font-size="12">Total Time = T_validation + T_processing + T_storage</text>
  <text x="700" y="1015" text-anchor="middle" class="formula" font-size="12">T_processing = T_LLM Ã— n_agents + T_tools Ã— n_calls</text>
  <text x="700" y="1035" text-anchor="middle" class="label-cn" font-size="10">é¢„æœŸæ€»æ—¶é•¿: 60-180ç§’ (å–å†³äºç›®çš„åœ°å¤æ‚åº¦ä¸APIå“åº”)</text>
  <text x="700" y="1055" text-anchor="middle" class="label-en" font-size="9">Expected Duration: 60-180s (depends on complexity and API latency)</text>

  <!-- Legend -->
  <text x="50" y="1085" class="label-cn" font-weight="bold" font-size="11">å›¾ä¾‹:</text>
  <line x1="100" y1="1080" x2="130" y2="1080" class="arrow"/>
  <text x="140" y="1085" class="label-cn" font-size="10">æ§åˆ¶æµ</text>
  <line x1="220" y1="1080" x2="250" y2="1080" class="arrow-data"/>
  <text x="260" y="1085" class="label-cn" font-size="10">æ•°æ®æµ</text>
</svg>